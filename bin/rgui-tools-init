#!/usr/bin/env node

'use strict';

let execSync = require('child_process').execSync;


let commander = require('commander');
commander
    .usage('<repo>')
    .option('-c, --components <components>', 'Component List, like: Sample1, AnotherSample')
    .parse(process.argv);

let repo = commander.args[0] + '';
if(!repo.startsWith('ui-'))
    return console.log('Repo name should start with `ui-`!');

const URL = 'https://github.com/regular-ui/ui-sample.git';

console.log(execSync([
    `git clone -b master ${URL} ${repo}`,
    `cd ${repo}`,
    `rm -rf .git`,
    `git init`,
    `git remote add origin https://github.com/regular-ui/${repo}.git`,
].join(';')) + '');
process.chdir(repo);

let components = commander.components.split(',');
if(!components.length)
    return;

components = components.map((component) => {
    return {
        name: component,
        lowerName: component[0].toLowerCase() + component.slice(1)
    }
});

console.log(execSync(`mv sample ${components[0].lowerName}`) + '');

// Replace
require('../gulp/replace/index.js');
let gulp = require('gulp');
gulp.components = components;
gulp.start('replace');

