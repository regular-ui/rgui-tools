#!/usr/bin/env node

'use strict';

let fs = require('fs');
let pkg = require('../package.json');
let chalk = require('chalk');
let gutil = require('gulp-util');
let prettyTime = require('pretty-hrtime');

let commander = require('commander');
commander
    .usage('[options] <task>')
    .version(pkg.version)
    .parse(process.argv);

let command = commander.args[0];
if(!command)
    commander.help();
else if(command === 'init') {
    let repo = commander.args[1] + '';
    if(!repo.startsWith('ui-'))
        return console.log('Repo name should start with `ui-`!');
} else if(command === 'publish') {
    let version = commander.args[1];
    if(!version)
        return console.log('Please input a version!');

  // 修改package.json

} else {
    if(!fs.existsSync(process.cwd() + '/package.json')) {
        console.error('error: Not a RGUI package');
        console.error('Please cd to a RGUI package directory or use `rgui-tools init` to create a new package.');
        return;
    }

    let gulp = require('../gulpfile.js');
    let logEvents = require('../lib/logEvents.js');
    logEvents(gulp);

    process.nextTick(function() {
        gulp.start(command);
    });
}

